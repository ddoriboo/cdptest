<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CDP AI ìì—°ì–´ ì¿¼ë¦¬ í”Œë«í¼ - Working</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .nav-tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
            overflow-x: auto;
        }
        
        .nav-tab {
            background: none;
            border: none;
            padding: 15px 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            white-space: nowrap;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            min-width: 120px;
        }
        
        .nav-tab:hover {
            background: #e9ecef;
        }
        
        .nav-tab.active {
            background: white;
            border-bottom-color: #4CAF50;
            color: #4CAF50;
        }
        
        .tab-content {
            display: none;
            padding: 30px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .query-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
        }
        
        .query-input-container {
            position: relative;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .query-input {
            width: 100%;
            padding: 20px 60px 20px 20px;
            font-size: 18px;
            border: 2px solid #e9ecef;
            border-radius: 25px;
            outline: none;
            transition: border-color 0.3s ease;
            background: white;
        }
        
        .query-input:focus {
            border-color: #4CAF50;
        }
        
        .query-button {
            position: absolute;
            right: 5px;
            top: 50%;
            transform: translateY(-50%);
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        .query-button:hover {
            transform: translateY(-50%) scale(1.05);
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.3);
        }
        
        /* ë‹´ë‹¹ìë³„ ì¶”ì²œ ì§ˆë¬¸ ì„¹ì…˜ */
        .team-recommendations {
            margin-top: 25px;
        }
        
        .team-recommendations h3 {
            text-align: center;
            margin-bottom: 20px;
            color: #2c3e50;
        }
        
        .team-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .team-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            text-align: center;
        }
        
        .team-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }
        
        .team-button .name {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .team-button .role {
            font-size: 12px;
            opacity: 0.9;
        }
        
        .recommended-questions {
            display: none;
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-top: 15px;
            border: 1px solid #e9ecef;
        }
        
        .recommended-questions.show {
            display: block;
            animation: slideDown 0.3s ease;
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .question-item {
            background: #f8f9fa;
            padding: 12px 15px;
            margin: 8px 0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 3px solid #4CAF50;
        }
        
        .question-item:hover {
            background: #e9ecef;
            transform: translateX(5px);
        }
        
        /* AI ì‚¬ê³  ê³¼ì • ì‹œê°í™” */
        .thinking-process {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            display: none;
        }
        
        .thinking-process.show {
            display: block;
        }
        
        .thinking-step {
            display: flex;
            align-items: center;
            padding: 15px;
            margin: 10px 0;
            background: white;
            border-radius: 10px;
            border-left: 4px solid #e9ecef;
            opacity: 0.3;
            transition: all 0.5s ease;
        }
        
        .thinking-step.active {
            opacity: 1;
            border-left-color: #4CAF50;
            transform: translateX(5px);
        }
        
        .thinking-step.completed {
            opacity: 1;
            border-left-color: #28a745;
            background: #f8fff9;
        }
        
        .step-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #e9ecef;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 18px;
            transition: all 0.3s ease;
        }
        
        .thinking-step.active .step-icon {
            background: #4CAF50;
            color: white;
            animation: pulse 1s infinite;
        }
        
        .thinking-step.completed .step-icon {
            background: #28a745;
            color: white;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        .step-content h4 {
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        .step-content p {
            color: #6c757d;
            font-size: 14px;
        }
        
        /* ì»¬ëŸ¼ ë¸Œë¼ìš°ì € */
        .column-browser {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
        }
        
        .search-filter-section {
            margin-bottom: 25px;
        }
        
        .search-box {
            width: 100%;
            padding: 15px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 16px;
            margin-bottom: 15px;
        }
        
        .filter-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .filter-btn {
            background: white;
            border: 1px solid #dee2e6;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .filter-btn.active {
            background: #4CAF50;
            color: white;
            border-color: #4CAF50;
        }
        
        .columns-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
        }
        
        .column-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            border: 1px solid #e9ecef;
            transition: all 0.3s ease;
        }
        
        .column-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        
        .column-name {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 8px;
            font-size: 16px;
        }
        
        .column-type {
            background: #e9ecef;
            color: #495057;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            margin-bottom: 10px;
            display: inline-block;
        }
        
        .column-description {
            color: #6c757d;
            font-size: 14px;
            margin-bottom: 15px;
        }
        
        .column-example {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
            color: #495057;
        }
        
        .stats-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .analysis-result {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            border-left: 5px solid #4CAF50;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            display: none;
        }
        
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #4CAF50;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .debug-info {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            font-size: 14px;
            color: #856404;
        }
        
        .error-info {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            font-size: 14px;
            color: #721c24;
        }
        
        .success-info {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            font-size: 14px;
            color: #155724;
        }
        
        @media (max-width: 768px) {
            .team-buttons {
                grid-template-columns: 1fr;
            }
            
            .columns-grid {
                grid-template-columns: 1fr;
            }
            
            .nav-tabs {
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¤– CDP AI ìì—°ì–´ ì¿¼ë¦¬ í”Œë«í¼</h1>
            <p>AIê°€ ë‹¨ê³„ë³„ë¡œ ë¶„ì„í•˜ì—¬ ìµœì ì˜ ê³ ê° ì„¸ê·¸ë¨¼í…Œì´ì…˜ ì „ëµì„ ì¶”ì²œí•©ë‹ˆë‹¤</p>
        </div>
        
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('query-analyzer')">ğŸ” ì¿¼ë¦¬ ë¶„ì„ê¸°</button>
            <button class="nav-tab" onclick="showTab('column-browser')">ğŸ“š ì»¬ëŸ¼ ë¸Œë¼ìš°ì €</button>
            <button class="nav-tab" onclick="showTab('team-recommendations')">ğŸ‘¥ íŒ€ë³„ ì¶”ì²œ</button>
        </div>
        
        <!-- ì¿¼ë¦¬ ë¶„ì„ê¸° íƒ­ -->
        <div id="query-analyzer" class="tab-content active">
            <div class="query-section">
                <div class="query-input-container">
                    <input type="text" 
                           class="query-input" 
                           id="queryInput" 
                           placeholder="ì˜ˆ: ëŒ€ì¶œ ë‹ˆì¦ˆê°€ ë†’ì€ ê³ ê°êµ° ì•Œë ¤ì¤˜, ì Šì€ ì—¬ì„± ì¤‘ ë·°í‹° ê´€ì‹¬ì‚¬ê°€ ë†’ì€ ê³ ê° ì°¾ì•„ì¤˜"
                           onkeypress="handleKeyPress(event)">
                    <button class="query-button" onclick="processQuery()">
                        ğŸ” AI ë¶„ì„
                    </button>
                </div>
                
                <!-- ë””ë²„ê¹… ì •ë³´ í™•ì¸ ë²„íŠ¼ -->
                <div style="text-align: center; margin-top: 15px;">
                    <button onclick="checkServerStatus()" style="background: #6c757d; color: white; border: none; padding: 8px 15px; border-radius: 20px; cursor: pointer; font-size: 12px;">
                        ğŸ”§ ì„œë²„ ìƒíƒœ í™•ì¸
                    </button>
                </div>
            </div>
            
            <!-- AI ì‚¬ê³  ê³¼ì • ì‹œê°í™” -->
            <div class="thinking-process" id="thinkingProcess">
                <h3>ğŸ§  AI ì‚¬ê³  ê³¼ì •</h3>
                <div class="thinking-step" id="step1">
                    <div class="step-icon">1ï¸âƒ£</div>
                    <div class="step-content">
                        <h4>ğŸ¯ ì§ˆë¬¸ ë¶„ì„ ê²°ê³¼</h4>
                        <p>ì‚¬ìš©ìì˜ ìì—°ì–´ ì§ˆë¬¸ì„ ë¶„ì„í•˜ê³  í•µì‹¬ ìš”êµ¬ì‚¬í•­ì„ íŒŒì•…í•©ë‹ˆë‹¤</p>
                    </div>
                </div>
                <div class="thinking-step" id="step2">
                    <div class="step-icon">2ï¸âƒ£</div>
                    <div class="step-content">
                        <h4>ğŸ‘¥ íƒ€ê²Ÿ ê³ ê°êµ° ì •ì˜</h4>
                        <p>ë¹„ì¦ˆë‹ˆìŠ¤ ëª©ì ì— ë§ëŠ” ìµœì ì˜ íƒ€ê²Ÿ ê³ ê°êµ°ì„ ì •ì˜í•©ë‹ˆë‹¤</p>
                    </div>
                </div>
                <div class="thinking-step" id="step3">
                    <div class="step-icon">3ï¸âƒ£</div>
                    <div class="step-content">
                        <h4>ğŸ“Š ì¶”ì²œ CDP ì»¬ëŸ¼ ì¡°í•©</h4>
                        <p>CDP ë°ì´í„°ì—ì„œ ìµœì ì˜ ì»¬ëŸ¼ ì¡°í•©ì„ ì¶”ì²œí•©ë‹ˆë‹¤</p>
                    </div>
                </div>
                <div class="thinking-step" id="step4">
                    <div class="step-icon">4ï¸âƒ£</div>
                    <div class="step-content">
                        <h4>ğŸ§  AI ë¶„ì„ ê·¼ê±°</h4>
                        <p>ê° ì»¬ëŸ¼ ì„ íƒì˜ ì´ìœ ì™€ ë¶„ì„ ê·¼ê±°ë¥¼ ì œì‹œí•©ë‹ˆë‹¤</p>
                    </div>
                </div>
                <div class="thinking-step" id="step5">
                    <div class="step-icon">5ï¸âƒ£</div>
                    <div class="step-content">
                        <h4>ğŸ“ ì‹¤í–‰ ê°€ëŠ¥í•œ SQL ì¿¼ë¦¬</h4>
                        <p>íƒ€ê²Ÿ ê³ ê°êµ°ì„ ì¶”ì¶œí•  ìˆ˜ ìˆëŠ” SQL ì¿¼ë¦¬ë¥¼ ìƒì„±í•©ë‹ˆë‹¤</p>
                    </div>
                </div>
                <div class="thinking-step" id="step6">
                    <div class="step-icon">6ï¸âƒ£</div>
                    <div class="step-content">
                        <h4>ğŸ’¡ ë¹„ì¦ˆë‹ˆìŠ¤ ì¸ì‚¬ì´íŠ¸ & ë§ˆì¼€íŒ… í™œìš©ë°©ì•ˆ</h4>
                        <p>ë¹„ì¦ˆë‹ˆìŠ¤ ì¸ì‚¬ì´íŠ¸ì™€ ë§ˆì¼€íŒ… í™œìš© ë°©ì•ˆì„ ë„ì¶œí•©ë‹ˆë‹¤</p>
                    </div>
                </div>
            </div>
            
            <div class="loading" id="loadingSection">
                <div class="spinner"></div>
                <p>ğŸ§  AIê°€ ë‹¨ê³„ë³„ë¡œ ë¶„ì„í•˜ê³  ìˆìŠµë‹ˆë‹¤...</p>
            </div>
            
            <div id="debugInfo"></div>
            <div id="analysisResults"></div>
        </div>
        
        <!-- ì»¬ëŸ¼ ë¸Œë¼ìš°ì € íƒ­ -->
        <div id="column-browser" class="tab-content">
            <div class="column-browser">
                <h2>ğŸ“š CDP ì»¬ëŸ¼ ë¸Œë¼ìš°ì €</h2>
                <p style="margin-bottom: 20px; color: #6c757d;">ì „ì²´ 847ê°œì˜ CDP ì»¬ëŸ¼ì„ ì¹´í…Œê³ ë¦¬ë³„ë¡œ íƒìƒ‰í•˜ê³  ê²€ìƒ‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                
                <div class="stats-section">
                    <div class="stat-card">
                        <div class="stat-number">52</div>
                        <div class="stat-label">ê´€ì‹¬ì‚¬ ì§€í‘œ</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">142</div>
                        <div class="stat-label">ì—…ì¢…ë³„ ì§€í‘œ</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">156</div>
                        <div class="stat-label">ì˜ˆì¸¡ ìŠ¤ì½”ì–´</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">497</div>
                        <div class="stat-label">í”Œë˜ê·¸ ì§€í‘œ</div>
                    </div>
                </div>
                
                <div class="search-filter-section">
                    <input type="text" class="search-box" id="columnSearch" placeholder="ì»¬ëŸ¼ëª…ì´ë‚˜ ì„¤ëª…ìœ¼ë¡œ ê²€ìƒ‰í•˜ì„¸ìš”..." onkeyup="filterColumns()">
                    
                    <div class="filter-buttons">
                        <button class="filter-btn active" onclick="filterByCategory('all')">ì „ì²´</button>
                        <button class="filter-btn" onclick="filterByCategory('interests')">ê´€ì‹¬ì‚¬ (fa_int_*)</button>
                        <button class="filter-btn" onclick="filterByCategory('industries')">ì—…ì¢…ë³„ (fa_ind_*)</button>
                        <button class="filter-btn" onclick="filterByCategory('scores')">ì˜ˆì¸¡ìŠ¤ì½”ì–´ (sc_*)</button>
                        <button class="filter-btn" onclick="filterByCategory('flags')">í”Œë˜ê·¸ (fi_npay_*)</button>
                    </div>
                </div>
                
                <div class="columns-grid" id="columnsGrid">
                    <!-- ì»¬ëŸ¼ ì¹´ë“œë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
                </div>
            </div>
        </div>
        
        <!-- íŒ€ë³„ ì¶”ì²œ íƒ­ -->
        <div id="team-recommendations" class="tab-content">
            <div class="query-section">
                <h2>ğŸ‘¥ íŒ€ë³„ ë§ì¶¤ ì¶”ì²œ ì§ˆë¬¸</h2>
                <p style="margin-bottom: 20px; color: #6c757d;">ê° ë‹´ë‹¹ìë‹˜ì˜ ì—…ë¬´ ì˜ì—­ì— íŠ¹í™”ëœ ì§ˆë¬¸ë“¤ì„ ì¶”ì²œë“œë¦½ë‹ˆë‹¤.</p>
                
                <div class="team-buttons">
                    <button class="team-button" onclick="showTeamQuestions('financial-content')">
                        <div class="name">ğŸ’° ì •ì„ ì˜ë‹˜</div>
                        <div class="role">ê¸ˆìœµ ì»¨í…ì¸  (ë¨¸ë‹ˆìŠ¤í† ë¦¬)</div>
                    </button>
                    <button class="team-button" onclick="showTeamQuestions('member-planning')">
                        <div class="name">ğŸ‘¥ ë°•ì§€ì˜ë‹˜</div>
                        <div class="role">íšŒì› í”Œë˜ë‹</div>
                    </button>
                    <button class="team-button" onclick="showTeamQuestions('myasset')">
                        <div class="name">ğŸ¦ ê¹€ì •í¬ë‹˜</div>
                        <div class="role">ë‚´ìì‚° í”Œë˜ë‹ (ë§ˆì´ë°ì´í„°)</div>
                    </button>
                    <button class="team-button" onclick="showTeamQuestions('advertising')">
                        <div class="name">ğŸ“¢ ê³ ì‹œí˜„ë‹˜</div>
                        <div class="role">AD ì„œë¹„ìŠ¤</div>
                    </button>
                    <button class="team-button" onclick="showTeamQuestions('payment')">
                        <div class="name">ğŸ’³ ìµœë™ì£¼ë‹˜</div>
                        <div class="role">ê²°ì œ ë°ì´í„°</div>
                    </button>
                    <button class="team-button" onclick="showTeamQuestions('loan')">
                        <div class="name">ğŸ  ì´ìŠ¹í•œë‹˜</div>
                        <div class="role">ëŒ€ì¶œ ì„œë¹„ìŠ¤</div>
                    </button>
                </div>
                
                <div class="recommended-questions" id="teamQuestions">
                    <!-- ì¶”ì²œ ì§ˆë¬¸ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // API í‚¤ëŠ” ì„œë²„ì—ì„œ ì œê³µë°›ì•„ì•¼ í•©ë‹ˆë‹¤ (ë³´ì•ˆìƒ í´ë¼ì´ì–¸íŠ¸ì— í•˜ë“œì½”ë”© ê¸ˆì§€)
        const OPENAI_API_KEY = null; // ì‹¤ì œ êµ¬í˜„ì‹œ ì„œë²„ì—ì„œ API í˜¸ì¶œ ì²˜ë¦¬
        
        // ì—¬ëŸ¬ ëª¨ë¸ì„ ì‹œë„í•  ìˆ˜ ìˆë„ë¡ ì„¤ì •
        const MODELS_TO_TRY = [
            'o3-mini-2025-01-31',
            'gpt-4o-mini',
            'gpt-4-turbo',
            'gpt-3.5-turbo'
        ];
        
        let currentModelIndex = 0;
        
        // ì „ì²´ CDP ì»¬ëŸ¼ ì •ì˜ (ì‹¤ì œ ë°ì´í„°ì— ë§ê²Œ í™•ì¥)
        const FULL_CDP_COLUMNS = {
            interests: {
                'fa_int_householdsingle': { desc: '1ì¸ ê°€êµ¬ ê´€ë ¨ ìƒí’ˆ ê²°ì œ ë˜ëŠ” ì˜¤í”¼ìŠ¤í…”/ì›ë£¸ ê±°ì£¼ ì¶”ì • ê³ ê°', type: 'date', example: 'WHERE fa_int_householdsingle IS NOT NULL' },
                'fa_int_householdpet': { desc: 'ë°˜ë ¤ë™ë¬¼ ê´€ë ¨ ìƒí’ˆ ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_int_householdpet IS NOT NULL' },
                'fa_int_householdchild': { desc: 'ì–´ë¦°ì´ ê´€ë ¨ ìƒí’ˆ ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_int_householdchild IS NOT NULL' },
                'fa_int_householdbaby': { desc: 'ì˜ìœ ì•„ ê´€ë ¨ ìƒí’ˆ ê²°ì œ ë˜ëŠ” ì¶œì‚° ì •ì±…ì§€ì›ê¸ˆ ìˆ˜ë ¹ ê³ ê°', type: 'date', example: 'WHERE fa_int_householdbaby IS NOT NULL' },
                'fa_int_householdyouth': { desc: 'ì¤‘ê³ ë“±í•™ìƒ ê´€ë ¨ ìƒí’ˆ ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_int_householdyouth IS NOT NULL' },
                'fa_int_publictransport': { desc: 'Npay êµí†µì¹´ë“œ ì´ìš© ë˜ëŠ” êµí†µë¹„ ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_int_publictransport IS NOT NULL' },
                'fa_int_motorcycle': { desc: 'ì˜¤í† ë°”ì´ ê´€ë ¨ ìƒí’ˆ ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_int_motorcycle IS NOT NULL' },
                'fa_int_loan1stfinancial': { desc: '1ê¸ˆìœµê¶Œì—ì„œ ì‹ ìš© ëŒ€ì¶œ ì‹¤í–‰ ê³ ê°', type: 'date', example: 'WHERE fa_int_loan1stfinancial IS NOT NULL' },
                'fa_int_loan2ndfinancial': { desc: 'ì €ì¶•ì€í–‰, ì¹´ë“œì‚¬, ë³´í—˜ì‚¬, ì¦ê¶Œì‚¬ ë“±ì—ì„œ ì‹ ìš© ëŒ€ì¶œ ì‹¤í–‰ ê³ ê°', type: 'date', example: 'WHERE fa_int_loan2ndfinancial IS NOT NULL' },
                'fa_int_loanpersonal': { desc: 'ì‹ ìš©ëŒ€ì¶œì„ ì‹¤í–‰ ê³ ê°', type: 'date', example: 'WHERE fa_int_loanpersonal IS NOT NULL' },
                'fa_int_saving': { desc: 'ì˜ˆì ê¸ˆ ê°œì„¤ ê³ ê°', type: 'date', example: 'WHERE fa_int_saving IS NOT NULL' },
                'fa_int_jeonsemonthlyrent': { desc: 'ê³„ì¢Œ ë° ëŒ€ì¶œì´ë ¥ì„ í†µí•œ ì „ì›”ì„¸ ê±°ì£¼ ì¶”ì • ê³ ê°', type: 'date', example: 'WHERE fa_int_jeonsemonthlyrent IS NOT NULL' },
                'fa_int_homeappliance': { desc: 'ê°€ì „ ìƒí’ˆ ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_int_homeappliance IS NOT NULL' },
                'fa_int_luxury': { desc: '100ë§Œì› ì´ìƒ ëª…í’ˆê´€ë ¨ ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_int_luxury IS NOT NULL' },
                'fa_int_delivery': { desc: 'ì‹ë¹„ ëª©ì ì˜ ë°°ë‹¬ ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_int_delivery IS NOT NULL' },
                'fa_int_mutualaidservice': { desc: 'ìƒì¡°ì„œë¹„ìŠ¤ ê´€ë ¨ ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_int_mutualaidservice IS NOT NULL' },
                'fa_int_interior': { desc: 'ì¸í…Œë¦¬ì–´ ê´€ë ¨ ìƒí’ˆ ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_int_interior IS NOT NULL' },
                'fa_int_carinsurance': { desc: 'í–¥í›„ 1ê°œì›” ìë™ì°¨ ë³´í—˜ ê²°ì œ ì˜ˆì •ìœ¼ë¡œ ì¶”ì •ë˜ëŠ” ê³ ê°', type: 'date', example: 'WHERE fa_int_carinsurance IS NOT NULL' },
                'fa_int_carpurchase': { desc: 'ë§ˆì´ì¹´ ë° ì˜¤í† ë¡ ì„ í†µí•œ ì°¨ëŸ‰ êµ¬ë§¤ ì¶”ì • ê³ ê°', type: 'date', example: 'WHERE fa_int_carpurchase IS NOT NULL' },
                'fa_int_overseasshopping': { desc: 'í•´ì™¸ì§êµ¬ ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_int_overseasshopping IS NOT NULL' },
                'fa_int_traveldomestic': { desc: 'êµ­ë‚´ì—¬í–‰ ê´€ë ¨ ìƒí’ˆ ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_int_traveldomestic IS NOT NULL' },
                'fa_int_travelpackage': { desc: 'ì—¬í–‰ì‚¬ íŒ¨í‚¤ì§€ ìƒí’ˆ ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_int_travelpackage IS NOT NULL' },
                'fa_int_traveloverseas': { desc: 'í–¥í›„ 1ê°œì›” ë‚´ í•´ì™¸ ì—¬í–‰ ëª©ì ì˜ ì¶œêµ­ ì˜ˆì • ì¶”ì • ê³ ê°', type: 'date', example: 'WHERE fa_int_traveloverseas IS NOT NULL' },
                'fa_int_travelasia': { desc: 'í–¥í›„ 1ê°œì›” ë‚´ ì•„ì‹œì•„ ì§€ì—­ìœ¼ë¡œ í•´ì™¸ì—¬í–‰ ëª©ì ì˜ ì¶œêµ­ ì˜ˆì • ì¶”ì • ê³ ê°', type: 'date', example: 'WHERE fa_int_travelasia IS NOT NULL' },
                'fa_int_golf': { desc: 'ê³¨í”„ìš©í’ˆ/ê³¨í”„ì¥ ê´€ë ¨ ìƒí’ˆ ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_int_golf IS NOT NULL' },
                'fa_int_running': { desc: 'ëŸ¬ë‹/ë§ˆë¼í†¤ ê´€ë ¨ ìƒí’ˆ ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_int_running IS NOT NULL' },
                'fa_int_swimming': { desc: 'ìˆ˜ì˜ ê´€ë ¨ ìƒí’ˆ ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_int_swimming IS NOT NULL' },
                'fa_int_pilatesyoga': { desc: 'í•„ë¼í…ŒìŠ¤/ìš”ê°€ ê´€ë ¨ ìƒí’ˆ ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_int_pilatesyoga IS NOT NULL' },
                'fa_int_gym': { desc: 'í”¼íŠ¸ë‹ˆìŠ¤/í—¬ìŠ¤ì¥ ê°€ë§¹ì  ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_int_gym IS NOT NULL' },
                'fa_int_wedding': { desc: 'ê²°í˜¼ ì¤€ë¹„ ê´€ë ¨ ìƒí’ˆ ê²°ì œ ë° í™œë™ ë°œìƒ ê³ ê°', type: 'date', example: 'WHERE fa_int_wedding IS NOT NULL' },
                'fa_int_retirement': { desc: 'í–¥í›„ 24ê°œì›” ë‚´ ì€í‡´ ì˜ˆì •ìœ¼ë¡œ ì¶”ì •ë˜ëŠ” ê³ ê°', type: 'date', example: 'WHERE fa_int_retirement IS NOT NULL' },
                'fa_int_move': { desc: 'ì£¼ì†Œì§€ ë³€ê²½ì´ë ¥ ì¡´ì¬ ë˜ëŠ” ì´ì‚¬ ê´€ë ¨ ìƒí’ˆ ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_int_move IS NOT NULL' },
                'fa_int_childbirth': { desc: 'ì„ì‹ /ì¶œì‚° ê´€ë ¨ ìƒí’ˆ ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_int_childbirth IS NOT NULL' },
                'fa_int_highincome': { desc: 'Nice ì¶”ì •ì†Œë“ 1ì–µì´ìƒ ê³ ê°', type: 'date', example: 'WHERE fa_int_highincome IS NOT NULL' },
                'fa_int_homeowner': { desc: 'ì£¼íƒ ì†Œìœ  ì¶”ì • ê³ ê°', type: 'date', example: 'WHERE fa_int_homeowner IS NOT NULL' },
                'fa_int_business': { desc: 'ëŒ€ì¶œ ë“±ì„ í†µí•œ ì‚¬ì—…ì ì¶”ì • ê³ ê°', type: 'date', example: 'WHERE fa_int_business IS NOT NULL' },
                'fa_int_youngprofessional': { desc: 'ê¸‰ì—¬ì…ê¸ˆì„ í†µí•´ ì·¨ì§ ì¶”ì • ê³ ê°', type: 'date', example: 'WHERE fa_int_youngprofessional IS NOT NULL' },
                'fa_int_pharmaceutical': { desc: 'ì œì•½ B2B ê°€ë§¹ì  ê³ ê°', type: 'date', example: 'WHERE fa_int_pharmaceutical IS NOT NULL' },
                'fa_int_worker': { desc: 'ì •ê¸°ì ìœ¼ë¡œ ê¸‰ì—¬ ë°›ëŠ” ê³ ê°', type: 'date', example: 'WHERE fa_int_worker IS NOT NULL' },
                'fa_int_fishing': { desc: 'ë‚šì‹œ ê´€ë ¨ ìƒí’ˆ ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_int_fishing IS NOT NULL' },
                'fa_int_diet': { desc: 'ë‹¤ì´ì–´íŠ¸ ëª©ì ì˜ ìƒí’ˆ ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_int_diet IS NOT NULL' },
                'fa_int_alcohol': { desc: 'ì£¼ë¥˜ ê´€ë ¨ ìƒí’ˆ ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_int_alcohol IS NOT NULL' },
                'fa_int_ott': { desc: 'OTT ê´€ë ¨ ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_int_ott IS NOT NULL' }
            },
            industries: {
                'fa_ind_education': { desc: 'êµìœ¡ ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_ind_education IS NOT NULL' },
                'fa_ind_academy': { desc: 'í•™ì› ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_ind_academy IS NOT NULL' },
                'fa_ind_transportation': { desc: 'êµí†µ ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_ind_transportation IS NOT NULL' },
                'fa_ind_finance': { desc: 'ê¸ˆìœµ ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_ind_finance IS NOT NULL' },
                'fa_ind_insurance': { desc: 'ë³´í—˜ ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_ind_insurance IS NOT NULL' },
                'fa_ind_beauty': { desc: 'ë¯¸ìš© ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_ind_beauty IS NOT NULL' },
                'fa_ind_medical': { desc: 'ì˜ë£Œ ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_ind_medical IS NOT NULL' },
                'fa_ind_travel': { desc: 'ì—¬í–‰ ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_ind_travel IS NOT NULL' },
                'fa_ind_foodbeverage': { desc: 'F&B ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_ind_foodbeverage IS NOT NULL' },
                'fa_ind_cafe': { desc: 'ì¹´í˜ ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_ind_cafe IS NOT NULL' },
                'fa_ind_restaurant': { desc: 'ìŒì‹ì  ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_ind_restaurant IS NOT NULL' },
                'fa_ind_cosmetic': { desc: 'ë·°í‹° ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_ind_cosmetic IS NOT NULL' },
                'fa_ind_fashion': { desc: 'íŒ¨ì…˜ì˜ë¥˜ ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_ind_fashion IS NOT NULL' },
                'fa_ind_digitalappliances': { desc: 'ë””ì§€í„¸ê°€ì „ ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_ind_digitalappliances IS NOT NULL' },
                'fa_ind_golfcourse': { desc: 'ê³¨í”„ì¥ ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_ind_golfcourse IS NOT NULL' },
                'fa_ind_fitness': { desc: 'í”¼íŠ¸ë‹ˆìŠ¤ ê²°ì œ ê³ ê°', type: 'date', example: 'WHERE fa_ind_fitness IS NOT NULL' }
            },
            scores: {
                'sc_int_householdsingle': { desc: '1ì¸ ê°€êµ¬ ê´€ë ¨ ìƒí’ˆ ê²°ì œ ì˜ˆì¸¡ìŠ¤ì½”ì–´', type: 'double', example: 'WHERE sc_int_householdsingle > 0.7' },
                'sc_int_householdpet': { desc: 'ë™ë¬¼ìš©í’ˆ/ë™ë¬¼ë³‘ì› ê²°ì œ ì˜ˆì¸¡ìŠ¤ì½”ì–´', type: 'double', example: 'WHERE sc_int_householdpet > 0.7' },
                'sc_int_loan1stfinancial': { desc: '1ê¸ˆìœµê¶Œ ì‹ ìš©ëŒ€ì¶œ ì˜ˆì¸¡ìŠ¤ì½”ì–´', type: 'double', example: 'WHERE sc_int_loan1stfinancial > 0.7' },
                'sc_int_loan2ndfinancial': { desc: '2ê¸ˆìœµê¶Œ ì‹ ìš©ëŒ€ì¶œ ì˜ˆì¸¡ìŠ¤ì½”ì–´', type: 'double', example: 'WHERE sc_int_loan2ndfinancial > 0.7' },
                'sc_int_luxury': { desc: 'ëª…í’ˆ êµ¬ë§¤ ì˜ˆì¸¡ìŠ¤ì½”ì–´', type: 'double', example: 'WHERE sc_int_luxury > 0.8' },
                'sc_int_delivery': { desc: 'ë°°ë‹¬ ì´ìš© ì˜ˆì¸¡ìŠ¤ì½”ì–´', type: 'double', example: 'WHERE sc_int_delivery > 0.6' },
                'sc_int_golf': { desc: 'ê³¨í”„ ê´€ë ¨ ì˜ˆì¸¡ìŠ¤ì½”ì–´', type: 'double', example: 'WHERE sc_int_golf > 0.7' },
                'sc_int_highincome': { desc: 'ê³ ì†Œë“ ì˜ˆì¸¡ìŠ¤ì½”ì–´', type: 'double', example: 'WHERE sc_int_highincome > 0.8' },
                'sc_int_wedding': { desc: 'ê²°í˜¼ ì¤€ë¹„ ì˜ˆì¸¡ìŠ¤ì½”ì–´', type: 'double', example: 'WHERE sc_int_wedding > 0.7' },
                'sc_ind_beauty': { desc: 'ë¯¸ìš© ì„œë¹„ìŠ¤ ì˜ˆì¸¡ìŠ¤ì½”ì–´', type: 'double', example: 'WHERE sc_ind_beauty > 0.7' },
                'sc_ind_cosmetic': { desc: 'ë·°í‹° ì œí’ˆ ì˜ˆì¸¡ìŠ¤ì½”ì–´', type: 'double', example: 'WHERE sc_ind_cosmetic > 0.8' },
                'sc_ind_finance': { desc: 'ê¸ˆìœµ ì„œë¹„ìŠ¤ ì˜ˆì¸¡ìŠ¤ì½”ì–´', type: 'double', example: 'WHERE sc_ind_finance > 0.7' }
            },
            flags: {
                'fi_npay_age20': { desc: '20ëŒ€', type: 'boolean', example: 'WHERE fi_npay_age20 = true' },
                'fi_npay_age30': { desc: '30ëŒ€', type: 'boolean', example: 'WHERE fi_npay_age30 = true' },
                'fi_npay_age40': { desc: '40ëŒ€', type: 'boolean', example: 'WHERE fi_npay_age40 = true' },
                'fi_npay_genderf': { desc: 'ì—¬ì„±', type: 'boolean', example: 'WHERE fi_npay_genderf = true' },
                'fi_npay_genderm': { desc: 'ë‚¨ì„±', type: 'boolean', example: 'WHERE fi_npay_genderm = true' },
                'fi_npay_membershipnormal': { desc: 'í”ŒëŸ¬ìŠ¤ë©¤ë²„ì‹­ ê°€ì…', type: 'boolean', example: 'WHERE fi_npay_membershipnormal = true' },
                'fi_npay_myassetreg': { desc: 'ë‚´ìì‚° ì„œë¹„ìŠ¤ ì—°ë™', type: 'boolean', example: 'WHERE fi_npay_myassetreg = true' },
                'fi_npay_creditcheck': { desc: 'ì‹ ìš©ì¡°íšŒ ì„œë¹„ìŠ¤ ê°€ì…', type: 'boolean', example: 'WHERE fi_npay_creditcheck = true' },
                'fi_npay_seoul': { desc: 'ì„œìš¸íŠ¹ë³„ì‹œ ê±°ì£¼', type: 'boolean', example: 'WHERE fi_npay_seoul = true' },
                'fi_npay_gyeonggi': { desc: 'ê²½ê¸°ë„ ê±°ì£¼', type: 'boolean', example: 'WHERE fi_npay_gyeonggi = true' }
            }
        };
        
        // íŒ€ë³„ ì¶”ì²œ ì§ˆë¬¸
        const TEAM_QUESTIONS = {
            'financial-content': [
                "íˆ¬ìì— ê´€ì‹¬ì´ ë§ì€ 30-40ëŒ€ ê³ ì†Œë“ì¸µ ê³ ê°ì„ ì°¾ì•„ì¤˜",
                "ìì‚°ê´€ë¦¬ ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•  ê°€ëŠ¥ì„±ì´ ë†’ì€ ê³ ê° ì„¸ê·¸ë¨¼íŠ¸ëŠ”?",
                "ê¸ˆìœµ êµìœ¡ ì»¨í…ì¸ ì— ê´€ì‹¬ì„ ë³´ì¼ ë§Œí•œ ê³ ê°êµ° ì¶”ì²œí•´ì¤˜",
                "ì‹ ìš©ì ìˆ˜ í–¥ìƒì— ê´€ì‹¬ì´ ë†’ì€ ê³ ê°ë“¤ì˜ íŠ¹ì„±ì„ ì•Œë ¤ì¤˜",
                "ë¶€ë™ì‚° íˆ¬ì ê´€ë ¨ ì»¨í…ì¸  íƒ€ê²Ÿ ê³ ê°ì„ ì°¾ì•„ì¤˜",
                "ì€í‡´ ì¤€ë¹„ì— ê´€ì‹¬ì´ ìˆëŠ” 50ëŒ€ ì´ìƒ ê³ ê°êµ°ì€?",
                "ì£¼ì‹ íˆ¬ì ê²½í—˜ì´ ìˆì„ ê²ƒ ê°™ì€ ê³ ê° í”„ë¡œí•„ì„ ë§Œë“¤ì–´ì¤˜"
            ],
            'member-planning': [
                "ì‹ ê·œ ê°€ì…ì ì¤‘ ì¥ê¸° ì´ìš© ê°€ëŠ¥ì„±ì´ ë†’ì€ ê³ ê° íŠ¹ì„±ì€?",
                "ì´íƒˆ ìœ„í—˜ì´ ë†’ì€ ê³ ê°ë“¤ì˜ ê³µí†µì ì„ ì°¾ì•„ì¤˜",
                "VIP ë“±ê¸‰ìœ¼ë¡œ ìŠ¹ê²©ì‹œí‚¬ ë§Œí•œ ê³ ê°ë“¤ì„ ì¶”ì²œí•´ì¤˜",
                "ë©¤ë²„ì‹­ í˜œíƒì„ ì ê·¹ í™œìš©í•˜ëŠ” ê³ ê°êµ°ì˜ íŠ¹ì§•ì€?",
                "í”ŒëŸ¬ìŠ¤ ë©¤ë²„ì‹­ ê°€ì… ê°€ëŠ¥ì„±ì´ ë†’ì€ ê³ ê°ì„ ì°¾ì•„ì¤˜",
                "ì„œë¹„ìŠ¤ ë§Œì¡±ë„ê°€ ë†’ì„ ê²ƒ ê°™ì€ ê³ ê° ì„¸ê·¸ë¨¼íŠ¸ëŠ”?",
                "ì¬ë°©ë¬¸ìœ¨ì´ ë†’ì€ ê³ ê°ë“¤ì˜ í–‰ë™ íŒ¨í„´ì„ ì•Œë ¤ì¤˜"
            ],
            'myasset': [
                "ë§ˆì´ë°ì´í„° ì—°ë™ì„ ìˆ˜ë½í•  ê°€ëŠ¥ì„±ì´ ë†’ì€ ê³ ê°ì€?",
                "ìì‚° ê´€ë¦¬ì— ì ê·¹ì ì¸ ê³ ê°ë“¤ì˜ íŠ¹ì„±ì„ ì•Œë ¤ì¤˜",
                "ë‚´ìì‚° ì„œë¹„ìŠ¤ ì‹ ê·œ ì´ìš©ìë¡œ ì í•©í•œ ê³ ê°êµ°ì€?",
                "ë‹¤ì–‘í•œ ê¸ˆìœµê¸°ê´€ì„ ì´ìš©í•˜ëŠ” ê³ ê° í”„ë¡œí•„ì„ ë§Œë“¤ì–´ì¤˜",
                "ë¶€ë™ì‚° ìì‚°ì„ ë³´ìœ í•œ ê³ ê°ë“¤ì˜ íŠ¹ì§•ì€?",
                "íˆ¬ì ìƒí’ˆì— ê´€ì‹¬ì´ ë§ì€ ìì‚°ê°€ë“¤ì„ ì°¾ì•„ì¤˜",
                "ì •ê¸°ì ìœ¼ë¡œ ìì‚°ì„ ì ê²€í•˜ëŠ” ê³ ê° ì„¸ê·¸ë¨¼íŠ¸ëŠ”?"
            ],
            'advertising': [
                "ê´‘ê³  í´ë¦­ë¥ ì´ ë†’ì„ ê²ƒ ê°™ì€ ê³ ê° ì„¸ê·¸ë¨¼íŠ¸ëŠ”?",
                "í”„ë¦¬ë¯¸ì—„ ìƒí’ˆ ê´‘ê³ ì— ë°˜ì‘í•  ê³ ê°êµ°ì„ ì°¾ì•„ì¤˜",
                "ëª¨ë°”ì¼ ê´‘ê³ ì— ì ê·¹ì ìœ¼ë¡œ ë°˜ì‘í•˜ëŠ” ê³ ê° íŠ¹ì„±ì€?",
                "ê³„ì ˆ ìƒí’ˆ ê´‘ê³  íƒ€ê²Ÿìœ¼ë¡œ ì í•©í•œ ê³ ê°ë“¤ì€?",
                "ë¸Œëœë“œ ì¶©ì„±ë„ê°€ ë†’ì€ ê³ ê°ë“¤ì˜ êµ¬ë§¤ íŒ¨í„´ì„ ì•Œë ¤ì¤˜",
                "ìƒˆë¡œìš´ ì„œë¹„ìŠ¤ í™ë³´ íƒ€ê²Ÿìœ¼ë¡œ ì¢‹ì€ ê³ ê°êµ°ì€?",
                "ì†Œì…œ ë¯¸ë””ì–´ ê´‘ê³ ì— ë°˜ì‘í•  ì Šì€ì¸µ ê³ ê°ì„ ì°¾ì•„ì¤˜"
            ],
            'payment': [
                "ê²°ì œ íŒ¨í„´ì´ ë³€í™”í•œ ê³ ê°ë“¤ì˜ íŠ¹ì§•ì„ ì•Œë ¤ì¤˜",
                "ì‹ ê·œ ê²°ì œ ìˆ˜ë‹¨ì„ ì‹œë„í•  ê°€ëŠ¥ì„±ì´ ë†’ì€ ê³ ê°ì€?",
                "ê²°ì œ ë¹ˆë„ê°€ ê¸‰ì¦í•œ ê³ ê° ì„¸ê·¸ë¨¼íŠ¸ë¥¼ ì°¾ì•„ì¤˜",
                "íŠ¹ì • ì—…ì¢…ì—ì„œ ê²°ì œê°€ í™œë°œí•œ ê³ ê°êµ°ì€?",
                "í˜„ê¸ˆ ê²°ì œì—ì„œ ì¹´ë“œ ê²°ì œë¡œ ì „í™˜í•œ ê³ ê°ë“¤ì˜ íŠ¹ì„±ì€?",
                "ì˜¨ë¼ì¸ ê²°ì œë¥¼ ì„ í˜¸í•˜ëŠ” ê³ ê°ë“¤ì˜ ì—°ë ¹ëŒ€ë³„ ë¶„í¬ëŠ”?",
                "ê²°ì œ ì‹¤íŒ¨ìœ¨ì´ ë‚®ì€ ì•ˆì •ì ì¸ ê³ ê° ê·¸ë£¹ì„ ì°¾ì•„ì¤˜"
            ],
            'loan': [
                "ëŒ€ì¶œ ì‹ ì²­ ê°€ëŠ¥ì„±ì´ ë†’ì€ ê³ ê° ì„¸ê·¸ë¨¼íŠ¸ëŠ”?",
                "ëŒ€í™˜ëŒ€ì¶œ ë‹ˆì¦ˆê°€ ìˆëŠ” ê³ ê°ë“¤ì„ ì°¾ì•„ì¤˜",
                "ì‹ ìš©ë“±ê¸‰ ê°œì„ ì— ê´€ì‹¬ì´ ë†’ì€ ê³ ê° íŠ¹ì„±ì€?",
                "ì£¼íƒë‹´ë³´ëŒ€ì¶œì„ ê³ ë ¤í•  ë§Œí•œ ê³ ê°êµ°ì€?",
                "ì „ì„¸ìê¸ˆëŒ€ì¶œì´ í•„ìš”í•œ ì Šì€ì¸µ ê³ ê°ì„ ì°¾ì•„ì¤˜",
                "ì‚¬ì—…ìëŒ€ì¶œì— ê´€ì‹¬ì´ ìˆì„ ê³ ê° í”„ë¡œí•„ì„ ë§Œë“¤ì–´ì¤˜",
                "ê¸°ì¡´ ëŒ€ì¶œ ê³ ê° ì¤‘ ì¶”ê°€ ëŒ€ì¶œ ê°€ëŠ¥ì„±ì´ ë†’ì€ ì‚¬ëŒë“¤ì€?"
            ]
        };
        
        let currentThinkingStep = 0;
        let currentFilter = 'all';
        
        // íƒ­ ì „í™˜
        function showTab(tabName) {
            // ëª¨ë“  íƒ­ ìˆ¨ê¸°ê¸°
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // ëª¨ë“  íƒ­ ë²„íŠ¼ ë¹„í™œì„±í™”
            document.querySelectorAll('.nav-tab').forEach(button => {
                button.classList.remove('active');
            });
            
            // ì„ íƒëœ íƒ­ ë³´ì´ê¸°
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            
            // ì»¬ëŸ¼ ë¸Œë¼ìš°ì € íƒ­ì´ ì„ íƒë˜ë©´ ì»¬ëŸ¼ ë¡œë“œ
            if (tabName === 'column-browser') {
                loadColumns();
            }
        }
        
        // ì»¬ëŸ¼ ë¡œë“œ
        function loadColumns() {
            const grid = document.getElementById('columnsGrid');
            if (grid.innerHTML.trim() === '') {
                renderColumns();
            }
        }
        
        // ì»¬ëŸ¼ ë Œë”ë§
        function renderColumns() {
            const grid = document.getElementById('columnsGrid');
            grid.innerHTML = '';
            
            Object.entries(FULL_CDP_COLUMNS).forEach(([category, columns]) => {
                if (currentFilter === 'all' || currentFilter === category) {
                    Object.entries(columns).forEach(([columnName, columnInfo]) => {
                        const card = createColumnCard(columnName, columnInfo, category);
                        grid.appendChild(card);
                    });
                }
            });
        }
        
        // ì»¬ëŸ¼ ì¹´ë“œ ìƒì„±
        function createColumnCard(columnName, columnInfo, category) {
            const card = document.createElement('div');
            card.className = 'column-card';
            card.innerHTML = `
                <div class="column-name">${columnName}</div>
                <div class="column-type">${columnInfo.type}</div>
                <div class="column-description">${columnInfo.desc}</div>
                <div class="column-example">${columnInfo.example}</div>
            `;
            return card;
        }
        
        // ì¹´í…Œê³ ë¦¬ë³„ í•„í„°ë§
        function filterByCategory(category) {
            currentFilter = category;
            
            // í•„í„° ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            renderColumns();
        }
        
        // ì»¬ëŸ¼ ê²€ìƒ‰
        function filterColumns() {
            const searchTerm = document.getElementById('columnSearch').value.toLowerCase();
            const cards = document.querySelectorAll('.column-card');
            
            cards.forEach(card => {
                const columnName = card.querySelector('.column-name').textContent.toLowerCase();
                const columnDesc = card.querySelector('.column-description').textContent.toLowerCase();
                
                if (columnName.includes(searchTerm) || columnDesc.includes(searchTerm)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }
        
        // íŒ€ë³„ ì¶”ì²œ ì§ˆë¬¸ í‘œì‹œ
        function showTeamQuestions(team) {
            const questionsDiv = document.getElementById('teamQuestions');
            const questions = TEAM_QUESTIONS[team];
            
            questionsDiv.innerHTML = `
                <h4>${getTeamName(team)} ë§ì¶¤ ì¶”ì²œ ì§ˆë¬¸</h4>
                ${questions.map(question => `
                    <div class="question-item" onclick="useQuestion('${question}')">
                        ${question}
                    </div>
                `).join('')}
            `;
            
            questionsDiv.classList.add('show');
        }
        
        // íŒ€ëª… ë°˜í™˜
        function getTeamName(team) {
            const teamNames = {
                'financial-content': 'ğŸ’° ì •ì„ ì˜ë‹˜ (ê¸ˆìœµ ì»¨í…ì¸ )',
                'member-planning': 'ğŸ‘¥ ë°•ì§€ì˜ë‹˜ (íšŒì› í”Œë˜ë‹)',
                'myasset': 'ğŸ¦ ê¹€ì •í¬ë‹˜ (ë‚´ìì‚° í”Œë˜ë‹)',
                'advertising': 'ğŸ“¢ ê³ ì‹œí˜„ë‹˜ (AD ì„œë¹„ìŠ¤)',
                'payment': 'ğŸ’³ ìµœë™ì£¼ë‹˜ (ê²°ì œ ë°ì´í„°)',
                'loan': 'ğŸ  ì´ìŠ¹í•œë‹˜ (ëŒ€ì¶œ ì„œë¹„ìŠ¤)'
            };
            return teamNames[team];
        }
        
        // ì¶”ì²œ ì§ˆë¬¸ ì‚¬ìš©
        function useQuestion(question) {
            // ì¿¼ë¦¬ ë¶„ì„ê¸° íƒ­ìœ¼ë¡œ ì´ë™
            showTab('query-analyzer');
            document.querySelector('.nav-tab').click();
            
            // ì§ˆë¬¸ ì…ë ¥
            document.getElementById('queryInput').value = question;
            
            // ìë™ ì‹¤í–‰
            setTimeout(() => {
                processQuery();
            }, 500);
        }
        
        // AI ì‚¬ê³  ê³¼ì • ì‹œë®¬ë ˆì´ì…˜
        function startThinkingProcess() {
            currentThinkingStep = 0;
            document.getElementById('thinkingProcess').classList.add('show');
            
            // ëª¨ë“  ë‹¨ê³„ ì´ˆê¸°í™”
            document.querySelectorAll('.thinking-step').forEach((step, index) => {
                step.classList.remove('active', 'completed');
            });
            
            // ë‹¨ê³„ë³„ ì§„í–‰
            const steps = document.querySelectorAll('.thinking-step');
            
            function nextStep() {
                if (currentThinkingStep > 0) {
                    steps[currentThinkingStep - 1].classList.remove('active');
                    steps[currentThinkingStep - 1].classList.add('completed');
                }
                
                if (currentThinkingStep < steps.length) {
                    steps[currentThinkingStep].classList.add('active');
                    currentThinkingStep++;
                    setTimeout(nextStep, 1500); // ê° ë‹¨ê³„ë§ˆë‹¤ 1.5ì´ˆ
                } else {
                    // ëª¨ë“  ë‹¨ê³„ ì™„ë£Œ - ê²°ê³¼ í‘œì‹œê°€ ì‹œì‘ë  ë•Œê¹Œì§€ ë³´ì´ê²Œ ë‘ê¸°
                    // displayResultsProgressivelyì—ì„œ ìˆ­ê¹€ ì²˜ë¦¬
                }
            }
            
            nextStep();
        }
        
        // í‚¤ ì…ë ¥ ì²˜ë¦¬
        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                processQuery();
            }
        }
        
        // ë””ë²„ê·¸ ì •ë³´ í‘œì‹œ (ìˆ¨ê¹€ ì²˜ë¦¬)
        function showDebugInfo(message, type = 'debug') {
            // ë””ë²„ê·¸ ì •ë³´ëŠ” ê°œë°œì ì½˜ì†”ì—ë§Œ í‘œì‹œ
            if (type === 'error') {
                console.error('ğŸš¨ Error:', message);
            } else if (type === 'success') {
                console.log('âœ… Success:', message);
            } else {
                console.log('ğŸ› Debug:', message);
            }
        }
        
        // ì¿¼ë¦¬ ì²˜ë¦¬ (ìˆ˜ì •ëœ ë²„ì „)
        async function processQuery() {
            const query = document.getElementById('queryInput').value.trim();
            
            if (!query) {
                alert('ì§ˆë¬¸ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // ë¡œë”© ë° ì‚¬ê³  ê³¼ì • ì‹œì‘
            document.getElementById('loadingSection').style.display = 'block';
            document.getElementById('analysisResults').innerHTML = '';
            document.getElementById('debugInfo').innerHTML = '';
            
            showDebugInfo('ë¶„ì„ ì‹œì‘: ' + query);
            startThinkingProcess();
            
            try {
                // ì‹¤ì œ OpenAI API í˜¸ì¶œ
                showDebugInfo('OpenAI API í˜¸ì¶œ ì¤‘...');
                const result = await analyzeQueryWithAI(query);
                showDebugInfo('API ì‘ë‹µ ë°›ìŒ, ê²°ê³¼ í‘œì‹œ ì¤‘...', 'success');
                displayResultsProgressively(result);
            } catch (error) {
                console.error('Error:', error);
                showDebugInfo('API ì˜¤ë¥˜ ë°œìƒ: ' + error.message, 'error');
                
                // í´ë°±ìœ¼ë¡œ ë”ë¯¸ ë°ì´í„° ì‚¬ìš©
                showDebugInfo('í´ë°± ë°ì´í„° ì‚¬ìš© ì¤‘...');
                const fallbackResult = generateFallbackResult(query);
                displayResultsProgressively(fallbackResult);
            } finally {
                document.getElementById('loadingSection').style.display = 'none';
            }
        }
        
        // ì„œë²„ API í˜¸ì¶œë¡œ ë³€ê²½ (ë³´ì•ˆ ê°œì„ )
        async function analyzeQueryWithAI(userQuery) {
            showDebugInfo('ì„œë²„ API í˜¸ì¶œ ì¤€ë¹„...');
            
            try {
                const response = await fetch('/api/analyze', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ query: userQuery })
                });
                
                showDebugInfo(`ì„œë²„ ì‘ë‹µ ìƒíƒœ: ${response.status}`);
                
                if (!response.ok) {
                    const errorText = await response.text();
                    showDebugInfo(`ì„œë²„ ì˜¤ë¥˜: ${errorText}`, 'error');
                    throw new Error(`Server error: ${response.status} - ${errorText}`);
                }
                
                const result = await response.json();
                showDebugInfo('ì„œë²„ ì‘ë‹µ ì„±ê³µ', 'success');
                return result;
                
            } catch (error) {
                showDebugInfo(`API í˜¸ì¶œ ì˜¤ë¥˜: ${error.message}`, 'error');
                throw error;
            }
        }
        
        // ë¶„ì„ í”„ë¡¬í”„íŠ¸ ìƒì„±
        function createAnalysisPrompt(query) {
            return `
ì‚¬ìš©ì ì§ˆë¬¸: "${query}"

ìœ„ ì§ˆë¬¸ì„ ë¶„ì„í•˜ì—¬ ë‹¤ìŒì„ ì œê³µí•´ì£¼ì„¸ìš”:

1. ì§ˆë¬¸ì˜ í•µì‹¬ ìš”êµ¬ì‚¬í•­ ë¶„ì„
2. íƒ€ê²Ÿ ê³ ê°êµ°ì„ ì •ì˜í•˜ê¸° ìœ„í•œ ìµœì ì˜ CDP ì»¬ëŸ¼ ì¡°í•© ì¶”ì²œ
3. ê° ì»¬ëŸ¼ì„ ì„ íƒí•œ ì´ìœ ì™€ ì¶”ì²œ ì¡°ê±´ê°’
4. ì‹¤í–‰ ê°€ëŠ¥í•œ SQL ì¿¼ë¦¬
5. ë¹„ì¦ˆë‹ˆìŠ¤ ì¸ì‚¬ì´íŠ¸ ë° ë§ˆì¼€íŒ… í™œìš© ë°©ì•ˆ

CDP ë°ì´í„°ì˜ íŠ¹ì„±:
- fa_int_*: ê´€ì‹¬ì‚¬ ê¸°ë°˜ í–‰ë™ ì§€í‘œ (date íƒ€ì…, ì´ë²¤íŠ¸ ë°œìƒì¼)
- fa_ind_*: ì—…ì¢…ë³„ ê²°ì œ ì§€í‘œ (date íƒ€ì…, ê²°ì œì¼)
- sc_*: AI ì˜ˆì¸¡ ìŠ¤ì½”ì–´ (0-1 ë²”ìœ„ì˜ double íƒ€ì…)
- fi_npay_*: í”Œë˜ê·¸ ì§€í‘œ (boolean íƒ€ì…)
            `;
        }
        
        // í´ë°± ê²°ê³¼ ìƒì„± (API ì‹¤íŒ¨ ì‹œ)
        function generateFallbackResult(query) {
            showDebugInfo('í´ë°± ë°ì´í„° ìƒì„± ì¤‘...');
            
            const loanKeywords = ['ëŒ€ì¶œ', 'ë¹Œë ¤', 'ì‹ ìš©', 'ê¸ˆìœµ', 'ëˆ'];
            const beautyKeywords = ['ë·°í‹°', 'í™”ì¥í’ˆ', 'ë¯¸ìš©', 'ì½”ìŠ¤ë©”í‹±'];
            const travelKeywords = ['ì—¬í–‰', 'í•´ì™¸', 'í•­ê³µ', 'í˜¸í…”'];
            
            let targetType = 'ì¼ë°˜';
            if (loanKeywords.some(keyword => query.includes(keyword))) {
                targetType = 'ëŒ€ì¶œ';
            } else if (beautyKeywords.some(keyword => query.includes(keyword))) {
                targetType = 'ë·°í‹°';
            } else if (travelKeywords.some(keyword => query.includes(keyword))) {
                targetType = 'ì—¬í–‰';
            }
            
            showDebugInfo(`íƒ€ê²Ÿ íƒ€ì… ê²°ì •: ${targetType}`);
            return generateTargetRecommendation(targetType, query);
        }
        
        // íƒ€ê²Ÿë³„ ì¶”ì²œ ìƒì„±
        function generateTargetRecommendation(targetType, originalQuery) {
            const recommendations = {
                'ëŒ€ì¶œ': {
                    query_analysis: `"${originalQuery}" - ì‚¬ìš©ìê°€ ëŒ€ì¶œ ìƒí’ˆì— ê´€ì‹¬ì´ ë†’ê³  ì‹ ì²­ ê°€ëŠ¥ì„±ì´ ìˆëŠ” ê³ ê°êµ°ì„ ìš”ì²­í–ˆìŠµë‹ˆë‹¤.`,
                    target_description: 'ì‹ ìš©ë„ê°€ ì–‘í˜¸í•˜ê³  ì•ˆì •ì ì¸ ì†Œë“ì„ ë³´ìœ í•˜ì—¬ ëŒ€ì¶œ ìƒí’ˆ ì´ìš© ê°€ëŠ¥ì„±ì´ ë†’ì€ ê³ ê°êµ°',
                    recommended_columns: [
                        {
                            column: 'sc_int_loan1stfinancial',
                            description: '1ê¸ˆìœµê¶Œ ì‹ ìš©ëŒ€ì¶œ ì˜ˆì¸¡ìŠ¤ì½”ì–´',
                            condition: '> 0.7',
                            priority: 'high',
                            reasoning: '1ê¸ˆìœµê¶Œì—ì„œ ëŒ€ì¶œë°›ì„ ê°€ëŠ¥ì„±ì´ ë†’ì•„ ì•ˆì •ì ì¸ ê³ ê°ì¸µìœ¼ë¡œ íŒë‹¨ë©ë‹ˆë‹¤.'
                        },
                        {
                            column: 'fa_int_loanpersonal',
                            description: 'ìµœê·¼ ì‹ ìš©ëŒ€ì¶œ ì‹¤í–‰ ì´ë ¥',
                            condition: 'IS NOT NULL',
                            priority: 'high',
                            reasoning: 'ê¸°ì¡´ ëŒ€ì¶œ ê²½í—˜ì´ ìˆì–´ ëŒ€ì¶œ ìƒí’ˆì— ëŒ€í•œ ì´í•´ë„ê°€ ë†’ê³  ì¶”ê°€ ë‹ˆì¦ˆê°€ ìˆì„ ê°€ëŠ¥ì„±ì´ í½ë‹ˆë‹¤.'
                        },
                        {
                            column: 'fi_npay_creditcheck',
                            description: 'ì‹ ìš©ì¡°íšŒ ì„œë¹„ìŠ¤ ê°€ì… ì—¬ë¶€',
                            condition: '= true',
                            priority: 'medium',
                            reasoning: 'ì‹ ìš©ê´€ë¦¬ì— ê´€ì‹¬ì´ ë†’ì•„ ëŒ€ì¶œ ìƒí’ˆ ì •ë³´ì—ë„ ì ê·¹ì ìœ¼ë¡œ ë°˜ì‘í•  ê²ƒìœ¼ë¡œ ì˜ˆìƒë©ë‹ˆë‹¤.'
                        },
                        {
                            column: 'sc_int_highincome',
                            description: 'ê³ ì†Œë“ ì˜ˆì¸¡ìŠ¤ì½”ì–´',
                            condition: '> 0.6',
                            priority: 'medium',
                            reasoning: 'ì•ˆì •ì ì¸ ì†Œë“ ê¸°ë°˜ìœ¼ë¡œ ëŒ€ì¶œ ìƒí™˜ ëŠ¥ë ¥ì´ ê²€ì¦ëœ ìš°ëŸ‰ ê³ ê°ì…ë‹ˆë‹¤.'
                        }
                    ],
                    sql_query: `SELECT mbr_id_no, 
       sc_int_loan1stfinancial,
       fa_int_loanpersonal,
       fi_npay_creditcheck,
       sc_int_highincome
FROM cdp_customer_data 
WHERE (sc_int_loan1stfinancial > 0.7)
   OR (fa_int_loanpersonal IS NOT NULL AND fi_npay_creditcheck = true)
   OR (sc_int_highincome > 0.6 AND fi_npay_creditcheck = true)
ORDER BY sc_int_loan1stfinancial DESC, sc_int_highincome DESC;`,
                    business_insights: [
                        'ê³ ì†Œë“ì¸µì¼ìˆ˜ë¡ ëŒ€ì¶œ í•œë„ê°€ ë†’ì•„ ìˆ˜ìµì„± ê´€ì ì—ì„œ ìš°ì„  íƒ€ê²ŸíŒ… í•„ìš”',
                        'ê¸°ì¡´ ëŒ€ì¶œ ê³ ê°ì˜ ëŒ€í™˜ëŒ€ì¶œ ë‹ˆì¦ˆë¥¼ ì ê·¹ ë°œêµ´í•˜ì—¬ ê³ ê° ìœ ì§€ ë° ìˆ˜ìµ ì¦ëŒ€ ê°€ëŠ¥',
                        'ì‹ ìš©ì¡°íšŒ ì„œë¹„ìŠ¤ ì´ìš©ìëŠ” ê¸ˆìœµ ìƒí’ˆ ê´€ì‹¬ë„ê°€ ë†’ì•„ ë§ˆì¼€íŒ… íš¨ê³¼ê°€ ì¢‹ìŒ',
                        '1ê¸ˆìœµê¶Œ ëŒ€ì¶œ ê°€ëŠ¥ ê³ ê°ì€ ì‹ ìš©ë„ê°€ ìš°ìˆ˜í•˜ì—¬ ì—°ì²´ ìœ„í—˜ì´ ë‚®ìŒ'
                    ],
                    estimated_target_size: '15-20%',
                    marketing_recommendations: [
                        'ê°œì¸ë³„ ì‹ ìš©ì ìˆ˜ë¥¼ í™œìš©í•œ ë§ì¶¤í˜• ëŒ€ì¶œ ìƒí’ˆ ë° ê¸ˆë¦¬ ì œì•ˆ',
                        'ê¸°ì¡´ ëŒ€ì¶œ ê³ ê° ëŒ€ìƒ ëŒ€í™˜ëŒ€ì¶œ ìƒë‹´ ë° ìš°ëŒ€ ì¡°ê±´ ì œê³µ',
                        'ì‹ ìš©ì¡°íšŒ ì„œë¹„ìŠ¤ ë‚´ì—ì„œ ëŒ€ì¶œ ìƒí’ˆ ì •ë³´ ìì—°ìŠ¤ëŸ½ê²Œ ë…¸ì¶œ',
                        'ê³ ì†Œë“ì¸µ ëŒ€ìƒ í”„ë¦¬ë¯¸ì—„ ëŒ€ì¶œ ìƒí’ˆ ë° ì „ìš© ìƒë‹´ ì„œë¹„ìŠ¤ ì œê³µ'
                    ]
                },
                'ë·°í‹°': {
                    query_analysis: `"${originalQuery}" - ë·°í‹° ë° í™”ì¥í’ˆ êµ¬ë§¤ì— ì ê·¹ì ì´ê³  ê´€ë ¨ ì†Œë¹„ê°€ í™œë°œí•œ ê³ ê°êµ°ì„ ìš”ì²­í–ˆìŠµë‹ˆë‹¤.`,
                    target_description: 'ë·°í‹° íŠ¸ë Œë“œì— ë¯¼ê°í•˜ê³  ê´€ë ¨ ì œí’ˆ êµ¬ë§¤ ë° ì„œë¹„ìŠ¤ ì´ìš©ì´ í™œë°œí•œ ê³ ê°êµ°',
                    recommended_columns: [
                        {
                            column: 'sc_ind_cosmetic',
                            description: 'ë·°í‹° ì œí’ˆ ê²°ì œ ì˜ˆì¸¡ìŠ¤ì½”ì–´',
                            condition: '> 0.8',
                            priority: 'high',
                            reasoning: 'ë·°í‹° ì œí’ˆ êµ¬ë§¤ ê°€ëŠ¥ì„±ì´ ë§¤ìš° ë†’ì€ í•µì‹¬ íƒ€ê²Ÿì¸µìœ¼ë¡œ ìš°ì„  ê³µëµ í•„ìš”í•©ë‹ˆë‹¤.'
                        },
                        {
                            column: 'fa_ind_beauty',
                            description: 'ë¯¸ìš© ì„œë¹„ìŠ¤ ê²°ì œ ì´ë ¥',
                            condition: 'IS NOT NULL',
                            priority: 'high',
                            reasoning: 'ë¯¸ìš©ì‹¤, ë„¤ì¼ìƒµ ë“± ë·°í‹° ì„œë¹„ìŠ¤ ì´ìš©ìœ¼ë¡œ ë·°í‹°ì— ëŒ€í•œ ê´€ì‹¬ë„ê°€ í™•ì¸ëœ ê³ ê°ì…ë‹ˆë‹¤.'
                        },
                        {
                            column: 'fi_npay_genderf',
                            description: 'ì—¬ì„± ê³ ê°',
                            condition: '= true',
                            priority: 'medium',
                            reasoning: 'ë·°í‹° ì œí’ˆì˜ ì£¼ìš” êµ¬ë§¤ì¸µì¸ ì—¬ì„± ê³ ê°ì„ ìš°ì„  íƒ€ê²ŸíŒ…í•´ì•¼ í•©ë‹ˆë‹¤.'
                        },
                        {
                            column: 'fi_npay_age20',
                            description: '20ëŒ€ ì—°ë ¹ì¸µ',
                            condition: '= true',
                            priority: 'medium',
                            reasoning: 'ë·°í‹° íŠ¸ë Œë“œì— ê°€ì¥ ë¯¼ê°í•˜ê³  ìƒˆë¡œìš´ ì œí’ˆ ì‹œë„ ì˜í–¥ì´ ë†’ì€ ì—°ë ¹ì¸µì…ë‹ˆë‹¤.'
                        }
                    ],
                    sql_query: `SELECT mbr_id_no,
       sc_ind_cosmetic,
       fa_ind_beauty,
       fi_npay_genderf,
       fi_npay_age20
FROM cdp_customer_data
WHERE (sc_ind_cosmetic > 0.8)
   OR (fa_ind_beauty IS NOT NULL AND fi_npay_genderf = true)
   OR (fi_npay_genderf = true AND fi_npay_age20 = true AND sc_ind_cosmetic > 0.5)
ORDER BY sc_ind_cosmetic DESC;`,
                    business_insights: [
                        'ì Šì€ ì—¬ì„±ì¸µì˜ ë·°í‹° ì§€ì¶œì´ ì§€ì†ì ìœ¼ë¡œ ì¦ê°€í•˜ëŠ” íŠ¸ë Œë“œ',
                        'ë¯¸ìš© ì„œë¹„ìŠ¤ì™€ ë·°í‹° ì œí’ˆì„ í•¨ê»˜ ì´ìš©í•˜ëŠ” ê³ ê°ì˜ ìƒì• ê°€ì¹˜(LTV)ê°€ ë†’ìŒ',
                        'ì˜¨ë¼ì¸ ë·°í‹° ì»¤ë¨¸ìŠ¤ ì‹œì¥ ê¸‰ì„±ì¥ìœ¼ë¡œ ë””ì§€í„¸ ë§ˆì¼€íŒ… ê¸°íšŒ í™•ëŒ€',
                        'ê°œì¸í™”ëœ ë·°í‹° ì†”ë£¨ì…˜ì— ëŒ€í•œ ìˆ˜ìš” ì¦ê°€'
                    ],
                    estimated_target_size: '25-30%',
                    marketing_recommendations: [
                        'ë·°í‹° ì¸í”Œë£¨ì–¸ì„œ ë° ì†Œì…œë¯¸ë””ì–´ë¥¼ í™œìš©í•œ ì œí’ˆ ì²´í—˜ ë§ˆì¼€íŒ…',
                        'ê°œì¸ í”¼ë¶€íƒ€ì… ë° ì„ í˜¸ë„ ê¸°ë°˜ ë§ì¶¤í˜• ë·°í‹° ë£¨í‹´ ì œì•ˆ',
                        'ë¯¸ìš©ì‹¤ ë°©ë¬¸ ê³ ê° ëŒ€ìƒ ë·°í‹° ì œí’ˆ í• ì¸ ì¿ í° ì œê³µ',
                        'ê³„ì ˆë³„ ë·°í‹° íŠ¸ë Œë“œ ì •ë³´ì™€ ì—°ê³„í•œ ì‹ ì œí’ˆ ì¶œì‹œ ì•Œë¦¼'
                    ]
                },
                'ì—¬í–‰': {
                    query_analysis: `"${originalQuery}" - ì—¬í–‰ì„ ìì£¼ ë‹¤ë‹ˆë©° ì—¬í–‰ ê´€ë ¨ ìƒí’ˆ ë° ì„œë¹„ìŠ¤ ì´ìš©ì´ í™œë°œí•œ ê³ ê°êµ°ì„ ìš”ì²­í–ˆìŠµë‹ˆë‹¤.`,
                    target_description: 'êµ­ë‚´ì™¸ ì—¬í–‰ ê²½í—˜ì´ í’ë¶€í•˜ê³  ì—¬í–‰ ê´€ë ¨ ì§€ì¶œì´ í™œë°œí•œ ê³ ê°êµ°',
                    recommended_columns: [
                        {
                            column: 'fa_int_traveloverseas',
                            description: 'í•´ì™¸ì—¬í–‰ ì˜ˆì • ê³ ê°',
                            condition: 'IS NOT NULL',
                            priority: 'high',
                            reasoning: 'í•´ì™¸ì—¬í–‰ ê³„íšì´ í™•ì •ëœ ê³ ê°ìœ¼ë¡œ ì—¬í–‰ ê´€ë ¨ ìƒí’ˆ êµ¬ë§¤ í™•ë¥ ì´ ë§¤ìš° ë†’ìŠµë‹ˆë‹¤.'
                        },
                        {
                            column: 'fa_ind_travel',
                            description: 'ì—¬í–‰ ê´€ë ¨ ê²°ì œ ì´ë ¥',
                            condition: 'IS NOT NULL',
                            priority: 'high',
                            reasoning: 'ì—¬í–‰ì‚¬, í•­ê³µê¶Œ ë“± ì—¬í–‰ ìƒí’ˆ êµ¬ë§¤ ê²½í—˜ì´ ìˆì–´ ì¬êµ¬ë§¤ ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤.'
                        },
                        {
                            column: 'fa_ind_airsevice',
                            description: 'í•­ê³µ ì„œë¹„ìŠ¤ ì´ìš©',
                            condition: 'IS NOT NULL',
                            priority: 'medium',
                            reasoning: 'í•­ê³µí¸ ì´ìš© ê²½í—˜ìœ¼ë¡œ ì¤‘ì¥ê±°ë¦¬ ì—¬í–‰ì„ ì„ í˜¸í•˜ëŠ” ê³ ê°ì„ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.'
                        },
                        {
                            column: 'sc_int_highincome',
                            description: 'ê³ ì†Œë“ ì˜ˆì¸¡ìŠ¤ì½”ì–´',
                            condition: '> 0.6',
                            priority: 'medium',
                            reasoning: 'ì—¬í–‰ì— ì¶©ë¶„í•œ ì§€ì¶œì´ ê°€ëŠ¥í•œ ê²½ì œì  ì—¬ë ¥ì„ ë³´ìœ í•œ ê³ ê°ì…ë‹ˆë‹¤.'
                        }
                    ],
                    sql_query: `SELECT mbr_id_no,
       fa_int_traveloverseas,
       fa_ind_travel,
       fa_ind_airsevice,
       sc_int_highincome
FROM cdp_customer_data
WHERE (fa_int_traveloverseas IS NOT NULL)
   OR (fa_ind_travel IS NOT NULL AND sc_int_highincome > 0.6)
   OR (fa_ind_airsevice IS NOT NULL AND fa_ind_travel IS NOT NULL)
ORDER BY sc_int_highincome DESC;`,
                    business_insights: [
                        'í¬ìŠ¤íŠ¸ ì½”ë¡œë‚˜ ì‹œëŒ€ í•´ì™¸ì—¬í–‰ ìˆ˜ìš”ê°€ ê¸‰ê²©íˆ íšŒë³µë˜ëŠ” ì¶”ì„¸',
                        'ê³ ì†Œë“ì¸µì¼ìˆ˜ë¡ í”„ë¦¬ë¯¸ì—„ ì—¬í–‰ ìƒí’ˆ ë° ë¶€ê°€ ì„œë¹„ìŠ¤ë¥¼ ì„ í˜¸',
                        'ì—¬í–‰ìë³´í—˜, í™˜ì „, ì—¬í–‰ìš©í’ˆ ë“± ë¶€ê°€ ì„œë¹„ìŠ¤ ë™ë°˜ ìˆ˜ìš” ì¦ê°€',
                        'ê°œì¸ ë§ì¶¤í˜• ì—¬í–‰ íŒ¨í‚¤ì§€ì— ëŒ€í•œ ê´€ì‹¬ë„ ìƒìŠ¹'
                    ],
                    estimated_target_size: '12-18%',
                    marketing_recommendations: [
                        'ì‹œì¦Œë³„ ì¸ê¸° ì—¬í–‰ì§€ ë° íŒ¨í‚¤ì§€ ìƒí’ˆ ë§ì¶¤ ì¶”ì²œ',
                        'ì—¬í–‰ìë³´í—˜ ìƒí’ˆê³¼ ì—¬í–‰ íŒ¨í‚¤ì§€ ë²ˆë“¤ ë§ˆì¼€íŒ…',
                        'í•­ê³µë§ˆì¼ë¦¬ì§€ ì ë¦½ ë° ì—¬í–‰ í˜œíƒ ê°•í™” í”„ë¡œê·¸ë¨',
                        'ì—¬í–‰ ê´€ë ¨ ê¸ˆìœµ ìƒí’ˆ(ì—¬í–‰ì ê¸ˆ, í™˜ì „ ì„œë¹„ìŠ¤) ì—°ê³„ ì œì•ˆ'
                    ]
                }
            };
            
            return recommendations[targetType] || {
                query_analysis: `"${originalQuery}"ì— ëŒ€í•œ ë¶„ì„ì„ ìˆ˜í–‰í–ˆìŠµë‹ˆë‹¤.`,
                target_description: 'ìš”ì²­í•˜ì‹  ì¡°ê±´ì— ë§ëŠ” ê³ ê°êµ°',
                recommended_columns: [],
                sql_query: 'SELECT * FROM cdp_customer_data LIMIT 100;',
                business_insights: ['ì¶”ê°€ ë¶„ì„ì´ í•„ìš”í•©ë‹ˆë‹¤.'],
                estimated_target_size: '10-15%',
                marketing_recommendations: ['ë§ì¶¤í˜• ë§ˆì¼€íŒ… ì „ëµì„ ìˆ˜ë¦½í•´ë³´ì„¸ìš”.']
            };
        }
        
        // ë¶„ì„ ë°©ë²• ë°°ë„ˆ ìƒì„±
        function createAnalysisMethodBanner(metadata) {
            if (!metadata) {
                return '<div class="debug-info">ë¶„ì„ ë°©ë²• ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
            }
            
            const { analysisMethod, processingTimeMs, timestamp } = metadata;
            
            let bannerClass, icon, title, description;
            
            switch (analysisMethod) {
                case 'openai':
                    bannerClass = 'success-info';
                    icon = 'ğŸ¤–';
                    title = 'AI ë¶„ì„ ì™„ë£Œ';
                    description = `OpenAI GPT ëª¨ë¸ì´ ì‹¤ì‹œê°„ìœ¼ë¡œ ë¶„ì„í–ˆìŠµë‹ˆë‹¤ (${processingTimeMs}ms)`;
                    break;
                case 'fallback_after_error':
                    bannerClass = 'error-info';
                    icon = 'âš ï¸';
                    title = 'AI ë¶„ì„ ì‹¤íŒ¨ - ëŒ€ì²´ ë¶„ì„ ì‚¬ìš©';
                    description = `OpenAI API ì˜¤ë¥˜ë¡œ ì¸í•´ í‚¤ì›Œë“œ ê¸°ë°˜ ë¶„ì„ìœ¼ë¡œ ì „í™˜í–ˆìŠµë‹ˆë‹¤ (${processingTimeMs}ms)`;
                    break;
                case 'fallback_no_key':
                    bannerClass = 'debug-info';
                    icon = 'ğŸ”‘';
                    title = 'í‚¤ì›Œë“œ ê¸°ë°˜ ë¶„ì„';
                    description = `OpenAI API í‚¤ê°€ ì„¤ì •ë˜ì§€ ì•Šì•„ í‚¤ì›Œë“œ ê¸°ë°˜ ë¶„ì„ì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤ (${processingTimeMs}ms)`;
                    break;
                default:
                    bannerClass = 'debug-info';
                    icon = 'â“';
                    title = 'ë¶„ì„ ë°©ë²• ë¶ˆëª…';
                    description = `ë¶„ì„ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤ (${processingTimeMs}ms)`;
            }
            
            return `
                <div class="${bannerClass}" style="margin-bottom: 20px; border-radius: 10px; animation: slideDown 0.5s ease;">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <span style="font-size: 1.2em;">${icon}</span>
                        <div>
                            <strong>${title}</strong><br>
                            <small>${description}</small><br>
                            <small style="opacity: 0.7;">ë¶„ì„ ì‹œê°: ${new Date(timestamp).toLocaleString('ko-KR')}</small>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // ë‹¨ê³„ë³„ ê²°ê³¼ í‘œì‹œ
        function displayResultsProgressively(result) {
            // thinking process ìˆ­ê¸°ê¸°
            setTimeout(() => {
                document.getElementById('thinkingProcess').style.display = 'none';
            }, 500);
            
            const resultsDiv = document.getElementById('analysisResults');
            resultsDiv.innerHTML = ''; // ì´ˆê¸°í™”
            
            // ë¶„ì„ ë°©ë²• í‘œì‹œ ë°°ë„ˆ ì¶”ê°€
            const methodBanner = createAnalysisMethodBanner(result._metadata);
            resultsDiv.innerHTML = methodBanner;
            
            const steps = [
                {
                    title: 'ğŸ¯ ì§ˆë¬¸ ë¶„ì„ ê²°ê³¼',
                    content: `<div class="analysis-result step-result" style="opacity: 0; transform: translateY(20px);">
                        <h3>ğŸ¯ ì§ˆë¬¸ ë¶„ì„ ê²°ê³¼</h3>
                        <p>${result.query_analysis}</p>
                    </div>`
                },
                {
                    title: 'ğŸ‘¥ íƒ€ê²Ÿ ê³ ê°êµ° ì •ì˜',
                    content: `<div class="analysis-result step-result" style="opacity: 0; transform: translateY(20px);">
                        <h3>ğŸ‘¥ íƒ€ê²Ÿ ê³ ê°êµ° ì •ì˜</h3>
                        <p>${result.target_description}</p>
                        <div class="stats-section" style="margin-top: 20px;">
                            <div class="stat-card">
                                <div class="stat-number">${result.recommended_columns.length}</div>
                                <div class="stat-label">ì¶”ì²œ ì»¬ëŸ¼ ìˆ˜</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number">${result.estimated_target_size}</div>
                                <div class="stat-label">ì˜ˆìƒ íƒ€ê²Ÿ ê·œëª¨</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number">${result.marketing_recommendations.length}</div>
                                <div class="stat-label">ë§ˆì¼€íŒ… ì œì•ˆ</div>
                            </div>
                        </div>
                    </div>`
                },
                {
                    title: 'ğŸ“Š ì¶”ì²œ CDP ì»¬ëŸ¼ ì¡°í•©',
                    content: `<div class="analysis-result step-result" style="opacity: 0; transform: translateY(20px);">
                        <h3>ğŸ“Š ì¶”ì²œ CDP ì»¬ëŸ¼ ì¡°í•©</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 20px 0;">
                            ${generateColumnRecommendations(result.recommended_columns)}
                        </div>
                    </div>`
                },
                {
                    title: 'ğŸ§  AI ë¶„ì„ ê·¼ê±°',
                    content: `<div class="step-result" style="opacity: 0; transform: translateY(20px); background: linear-gradient(135deg, #ff7e5f 0%, #feb47b 100%); color: white; padding: 25px; border-radius: 15px; margin: 20px 0;">
                        <h4>ğŸ§  AI ë¶„ì„ ê·¼ê±°</h4>
                        ${result.recommended_columns.map(col => `
                            <div style="background: rgba(255, 255, 255, 0.1); padding: 12px 15px; margin: 10px 0; border-radius: 8px; border-left: 3px solid rgba(255, 255, 255, 0.3);">
                                <strong>${col.column}:</strong> ${col.reasoning}
                            </div>
                        `).join('')}
                    </div>`
                },
                {
                    title: 'ğŸ“ ì‹¤í–‰ ê°€ëŠ¥í•œ SQL ì¿¼ë¦¬',
                    content: `<div class="step-result" style="opacity: 0; transform: translateY(20px); background: #2c3e50; color: white; padding: 25px; border-radius: 15px; margin: 20px 0;">
                        <h4>ğŸ“ ì‹¤í–‰ ê°€ëŠ¥í•œ SQL ì¿¼ë¦¬</h4>
                        <div style="background: #34495e; padding: 15px; border-radius: 8px; font-family: 'Courier New', monospace; font-size: 14px; overflow-x: auto; white-space: pre-wrap;">${result.sql_query}</div>
                        <button style="background: #3498db; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; margin-top: 10px; font-size: 12px;" onclick="copyToClipboard(\`${result.sql_query.replace(/`/g, '\\`')}\`)">
                            ğŸ“‹ ì¿¼ë¦¬ ë³µì‚¬
                        </button>
                    </div>`
                },
                {
                    title: 'ğŸ’¡ ë¹„ì¦ˆë‹ˆìŠ¤ ì¸ì‚¬ì´íŠ¸ & ë§ˆì¼€íŒ… í™œìš©ë°©ì•ˆ',
                    content: `<div class="analysis-result step-result" style="opacity: 0; transform: translateY(20px);">
                        <h3>ğŸ’¡ ë¹„ì¦ˆë‹ˆìŠ¤ ì¸ì‚¬ì´íŠ¸</h3>
                        ${result.business_insights.map(insight => `<p>â€¢ ${insight}</p>`).join('')}
                    </div>
                    <div class="analysis-result step-result" style="opacity: 0; transform: translateY(20px); margin-top: 20px;">
                        <h3>ğŸš€ ë§ˆì¼€íŒ… í™œìš© ë°©ì•ˆ</h3>
                        ${result.marketing_recommendations.map(rec => `<p>â€¢ ${rec}</p>`).join('')}
                    </div>`
                }
            ];
            
            // ê° ë‹¨ê³„ë¥¼ ìˆœì°¨ì ìœ¼ë¡œ í‘œì‹œ
            let currentStep = 0;
            
            function showNextStep() {
                if (currentStep < steps.length) {
                    // ë‹¤ìŒ ë‹¨ê³„ ì¶”ê°€
                    resultsDiv.innerHTML += steps[currentStep].content;
                    
                    // ë°©ê¸ˆ ì¶”ê°€ëœ ìš”ì†Œë“¤ì— ì• ë‹ˆë©”ì´ì…˜ ì ìš©
                    const newElements = resultsDiv.querySelectorAll('.step-result');
                    const latestElements = Array.from(newElements).slice(-1); // ë§ˆì§€ë§‰ ìš”ì†Œë§Œ
                    
                    if (steps[currentStep].title === 'ğŸ’¡ ë¹„ì¦ˆë‹ˆìŠ¤ ì¸ì‚¬ì´íŠ¸ & ë§ˆì¼€íŒ… í™œìš©ë°©ì•ˆ') {
                        // ë§ˆì§€ë§‰ ë‹¨ê³„ëŠ” ë‘ ê°œì˜ ìš”ì†Œê°€ ìˆìŒ
                        const lastTwoElements = Array.from(newElements).slice(-2);
                        lastTwoElements.forEach(element => {
                            setTimeout(() => {
                                element.style.transition = 'all 0.8s ease-out';
                                element.style.opacity = '1';
                                element.style.transform = 'translateY(0)';
                            }, 100);
                        });
                    } else {
                        latestElements.forEach(element => {
                            setTimeout(() => {
                                element.style.transition = 'all 0.8s ease-out';
                                element.style.opacity = '1';
                                element.style.transform = 'translateY(0)';
                            }, 100);
                        });
                    }
                    
                    currentStep++;
                    
                    // ë‹¤ìŒ ë‹¨ê³„ë¥¼ 1.5ì´ˆ í›„ì— í‘œì‹œ
                    setTimeout(showNextStep, 1500);
                } else {
                    // ëª¨ë“  ë‹¨ê³„ ì™„ë£Œ
                    showDebugInfo('ëª¨ë“  ê²°ê³¼ í‘œì‹œ ì™„ë£Œ', 'success');
                }
            }
            
            // ì²« ë‹¨ê³„ ì‹œì‘
            showNextStep();
        }
        
        // ì»¬ëŸ¼ ì¶”ì²œ HTML ìƒì„±
        function generateColumnRecommendations(columns) {
            const grouped = {
                high: columns.filter(c => c.priority === 'high'),
                medium: columns.filter(c => c.priority === 'medium'),
                low: columns.filter(c => c.priority === 'low')
            };
            
            return Object.entries(grouped).map(([priority, cols]) => {
                if (cols.length === 0) return '';
                
                const priorityLabels = {
                    high: 'ğŸ”¥ í•µì‹¬ ì§€í‘œ',
                    medium: 'â­ ë³´ì¡° ì§€í‘œ',
                    low: 'ğŸ’¡ ì°¸ê³  ì§€í‘œ'
                };
                
                return `
                    <div style="background: white; padding: 20px; border-radius: 10px; border: 1px solid #e9ecef;">
                        <h4 style="color: #495057; margin-bottom: 15px; font-size: 1.1em;">${priorityLabels[priority]}</h4>
                        ${cols.map(col => `
                            <div style="background: #f8f9fa; padding: 10px 15px; margin: 8px 0; border-radius: 8px; border-left: 3px solid #4CAF50;">
                                <div style="font-weight: 500; color: #2c3e50;">${col.column}</div>
                                <div style="font-size: 0.9em; color: #6c757d; margin-top: 2px;">${col.description}</div>
                                <div style="font-size: 0.8em; color: #4CAF50; margin-top: 2px;">ì¡°ê±´: ${col.condition}</div>
                            </div>
                        `).join('')}
                    </div>
                `;
            }).join('');
        }
        
        // ì—ëŸ¬ í‘œì‹œ
        function displayError(message) {
            const resultsDiv = document.getElementById('analysisResults');
            resultsDiv.innerHTML = `
                <div class="analysis-result" style="border-left-color: #dc3545;">
                    <h3 style="color: #dc3545;">âš ï¸ ì˜¤ë¥˜ ë°œìƒ</h3>
                    <p>${message}</p>
                </div>
            `;
        }
        
        // í´ë¦½ë³´ë“œ ë³µì‚¬
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert('ì¿¼ë¦¬ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
            });
        }
        
        // ì„œë²„ ìƒíƒœ í™•ì¸
        async function checkServerStatus() {
            try {
                showDebugInfo('ì„œë²„ ìƒíƒœ í™•ì¸ ì¤‘...', 'debug');
                
                const response = await fetch('/api/debug');
                const data = await response.json();
                
                let statusMessage = `ğŸ–¥ï¸ ì„œë²„ ìƒíƒœ ì •ë³´\n\n`;
                statusMessage += `â° ì‹œê°„: ${new Date(data.timestamp).toLocaleString('ko-KR')}\n`;
                statusMessage += `ğŸŒ í™˜ê²½: ${data.environment}\n`;
                statusMessage += `ğŸ”‘ OpenAI API í‚¤: ${data.hasOpenAIKey ? 'âœ… ì„¤ì •ë¨' : 'âŒ ì—†ìŒ'}\n`;
                
                if (data.hasOpenAIKey) {
                    statusMessage += `ğŸ“ API í‚¤ ê¸¸ì´: ${data.apiKeyLength}ì\n`;
                    statusMessage += `ğŸ”¤ API í‚¤ ì‹œì‘: ${data.apiKeyPrefix}\n`;
                } else {
                    statusMessage += `âš ï¸ Railwayì—ì„œ OPENAI_API_KEY í™˜ê²½ë³€ìˆ˜ë¥¼ ì„¤ì •í•´ì£¼ì„¸ìš”.\n`;
                }
                
                statusMessage += `ğŸš€ ì„œë²„: ${data.serverStatus}`;
                
                alert(statusMessage);
                showDebugInfo('ì„œë²„ ìƒíƒœ í™•ì¸ ì™„ë£Œ', 'success');
                
            } catch (error) {
                console.error('ì„œë²„ ìƒíƒœ í™•ì¸ ì˜¤ë¥˜:', error);
                showDebugInfo(`ì„œë²„ ìƒíƒœ í™•ì¸ ì‹¤íŒ¨: ${error.message}`, 'error');
                alert(`âŒ ì„œë²„ ìƒíƒœ í™•ì¸ ì‹¤íŒ¨\n\n${error.message}`);
            }
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Working CDP AI ìì—°ì–´ ì¿¼ë¦¬ í”Œë«í¼ì´ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.');
            document.getElementById('queryInput').focus();
        });
    </script>
</body>
</html>